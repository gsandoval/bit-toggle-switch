/**
 * bit-toggle-switch
 * @version v0.0.1 - 2014-08-01
 * @link https://github.com/gsandoval/bit-toggle-switch
 * @author Guillermo Sandoval <gsandoval@darchitect.org>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a){"use strict";a.module("bitToggleSwitch").directive("bitToggleSwitch",[function(){var a=0;return{restrict:"A",scope:{status:"=hbToggleSwitch",beforeCb:"&hbToggleSwitchBefore",labels:"=hbToggleSwitchLabels"},template:function(){return'<div class="toggle-switch" data-ng-click="toggle()"><div class="on-state state" data-ng-class="{ \'on-state-visible\': status, \'on-state-hidden\': !status }"><div class="state-label">{{labels.on}}</div><div class="indicator"></div></div><div class="off-state state" data-ng-class="{ \'off-state-visible\': !status, \'off-state-hidden\': status }"><div class="indicator"></div><div class="state-label">{{labels.off}}</div></div></div>'},transclude:!0,link:function(b,c,d,e,f){function g(){f(b.$parent,function(a){for(var b=0,d=a.length;d>b;b++){var e=angular.element(a[b]),f=e.attr("data-hb-toggle-switch-off"),g=e.attr("data-hb-toggle-switch-on");void 0!==f&&f!==!1&&(c.find(".off-state").append(e),c.find(".off-state .state-label").remove()),void 0!==g&&g!==!1&&(c.find(".on-state").append(e),c.find(".on-state .state-label").remove())}}),"boolean"!=typeof b.status&&(b.status=!1),b.labels.on||(b.labels.on="On"),b.labels.off||(b.labels.off="Off");var a=p.height()+parseFloat(p.css("margin-top"))+parseFloat(p.css("margin-bottom"));c.find(".toggle-switch").css("height",Math.ceil(a)+"px");for(var d=i(),e=c.find(".state-label"),g=0,j=e.length;j>g;g++){var k=angular.element(e[g]);k.css("width",d+"px");var l=Math.ceil(parseFloat(k.css("margin-left"))+parseFloat(k.css("margin-right")));o=Math.max(o,d+l);var q=k.parent();l=Math.ceil(parseFloat(q.css("margin-left"))+parseFloat(q.css("margin-right"))),n=Math.max(n,k.parent().width()+l)}c.css("width",n),c.addClass(m),h(o)}function h(a){var b=document.createElement("style");b.type="text/css",b.innerHTML="."+m+" .on-state-visible { left: 0; } ."+m+" .on-state-hidden { left: -"+a+"px; } ."+m+" .off-state-visible { left: 0; } ."+m+" .off-state-hidden { left: "+a+"px; }",document.getElementsByTagName("head")[0].appendChild(b)}function i(){var a=0,d=angular.element('<div style="position: absolute; float: left; white-space: nowrap; visibility: hidden;"></div>');return c.append(d),a=Math.max(a,j(d,c.find("[data-hb-toggle-switch-on]"),b.labels.on)),a=Math.max(a,j(d,c.find("[data-hb-toggle-switch-off]"),b.labels.off)),d.remove(),a}function j(a,b,c){var d=0;return b.length>0?d=Math.max(d,Math.ceil(b.width())):(a.html(c),d=Math.ceil(a.width())),d}function k(){b.beforeCb()?b.beforeCb()(!b.status).then(function(){b.status=!b.status},function(){}):b.status=!b.status}var l=a++,m="toggle-switch-"+l,n=0,o=0,p=(c.find(".off-state"),c.find(".on-state"));b.$watch("status",function(){}),b.toggle=k,g()}}}])}(angular);